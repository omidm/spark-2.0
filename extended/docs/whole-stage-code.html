<!DOCTYPE html>
<html><head>
  <meta name="databricks-html-version" content="1">
<title>Whole-stage code generation - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="Whole-stage%20code%20generation%20-%20Databricks_files/css.css">

<link rel="stylesheet" type="text/css" href="Whole-stage%20code%20generation%20-%20Databricks_files/bootstrap.css">
<link rel="stylesheet" type="text/css" href="Whole-stage%20code%20generation%20-%20Databricks_files/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="Whole-stage%20code%20generation%20-%20Databricks_files/main.css">
<link rel="stylesheet" href="Whole-stage%20code%20generation%20-%20Databricks_files/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico">
<script>window.settings = {"enableSshKeyUI":false,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enablePublishNotebooks":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Scala 2.11 experimental)","packageLabel":"spark-image-a8c921ec1104ad2a949bfcb0d4e65d8c34b6c6944c4fe292e9ca289359e2564e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Scala 2.10)","packageLabel":"spark-image-e30f8cdf9c176d39ddbe4140b4b11c961bb0b575ae8579c820f12c9b954946c5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.25","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"gitHash":"20160808103017","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":false};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":293651311471490,"name":"Whole-stage code generation","language":"scala","commands":[{"version":"CommandV1","origId":431554386690945,"guid":"0c4651b1-033b-485d-9c0b-c865d9968315","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Whole-stage code generation: Spark 2.0's Tungsten engine\n\nThis notebook demonstrates the power of whole-stage code generation, a technique that blends state-of-the-art from modern compilers and MPP databases. In order to compare the performance with Spark 1.6, we turn off whole-stage code generation in Spark 2.0, which would result in using a similar code path as in Spark 1.6.\n\nTo read the companion blog posts, click the following:\n- https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html\n- https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46403536403E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6901cd5e-f713-4c7c-95f8-d958a6b02b57"},{"version":"CommandV1","origId":431554386690946,"guid":"9785e801-f510-4b99-a66f-066fd402ee21","subtype":"command","commandType":"auto","position":0.75,"command":"%md\n### First, let's do some benchmark setup","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364031E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ecbbb677-5c04-4d4f-969d-389d52a7217e"},{"version":"CommandV1","origId":431554386690947,"guid":"c1783d56-f4f7-4418-8ead-a5dd1c1d5d51","subtype":"command","commandType":"auto","position":0.875,"command":"// Define a simple benchmark util function\ndef benchmark(name: String)(f: => Unit) {\n  val startTime = System.nanoTime\n  f\n  val endTime = System.nanoTime\n  println(s\"Time taken in $name: \" + (endTime - startTime).toDouble / 1000000000 + \" seconds\")\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464038690086E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ce88c95f-3382-4be5-844f-8b0ebd97858c"},{"version":"CommandV1","origId":431554386690956,"guid":"85449eed-7323-464d-89e7-7f05f1c8b04d","subtype":"command","commandType":"auto","position":0.90625,"command":"%md\nThis \"cluster\" has only a single node, with 3 cores allocated. The CPU is Intel(R) Xeon(R) CPU E5-2670 v2 @ 2.50GHz.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364038E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"86692197-67da-4fbf-874c-26d6bc7c1407"},{"version":"CommandV1","origId":431554386690948,"guid":"532de9dc-79f4-4ce2-b195-3c3b93da4c10","subtype":"command","commandType":"auto","position":0.9375,"command":"%md\n### How fast can Spark 1.6 sum up 1 billion numbers?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364041E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"611b2713-0227-4b97-b9cc-ecbe36e57b74"},{"version":"CommandV1","origId":431554386690949,"guid":"f1f9ebd6-206c-489d-ac1b-936c6f278207","subtype":"command","commandType":"auto","position":0.96875,"command":"// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.\nspark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).selectExpr(\"sum(id)\").show()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464038731919E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"88475b95-1b34-4f46-a863-1e33983f9922"},{"version":"CommandV1","origId":431554386690950,"guid":"c6f4b542-413c-4826-89e5-b4e766eb792a","subtype":"command","commandType":"auto","position":0.984375,"command":"%md\n### How fast can Spark 2.0 sum up 1 billion numbers?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364048E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"847068d3-0d29-4067-b837-cff25bb9e99e"},{"version":"CommandV1","origId":431554386690951,"guid":"000895cf-c723-4432-8e05-627d19afee68","subtype":"command","commandType":"auto","position":0.9921875,"command":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.0\") {\n  spark.range(1000L * 1000 * 1000).selectExpr(\"sum(id)\").show()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464038809203E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4660abc3-9d8c-4109-8ed8-4f4d33f25961"},{"version":"CommandV1","origId":431554386690959,"guid":"1b50fb73-26bc-4ec3-a2a0-4d386b7a31db","subtype":"command","commandType":"auto","position":0.994140625,"command":"%md\nWoot - that's pretty good. From ~ 8 seconds to 0.7 seconds to sum up 1 billion numbers.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364055E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e44b7a3d-d905-4e6e-be95-6ff7297fe1a1"},{"version":"CommandV1","origId":431554386690952,"guid":"cd4f0836-b5ac-4811-8be1-f6f5918a0407","subtype":"command","commandType":"auto","position":0.99609375,"command":"%md\n### How fast can Spark 1.6 join 1 billion records?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364058E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4cd65447-312a-4bb6-87b7-83e05178afbb"},{"version":"CommandV1","origId":431554386690953,"guid":"90288f57-26af-4574-befc-b820c54e97b5","subtype":"command","commandType":"auto","position":0.998046875,"command":"// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.\nspark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").count()\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Time taken in Spark 1.6: 67.949386495 seconds\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.464038904103E12,"submitTime":1.464038888349E12,"finishTime":1.464038972176E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d275b4e4-6b28-413d-8d9c-c453bc6dcffc"},{"version":"CommandV1","origId":781724370396894,"guid":"2bc0aef9-599b-4419-9d4a-1d1da1425e42","subtype":"command","commandType":"auto","position":0.99853515625,"command":"spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").selectExpr(\"count(*)\").explain(true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Parsed Logical Plan ==\n'Project [unresolvedalias('count(1), Some(count(1)))]\n+- Project [id#782L]\n   +- Join Inner, Some((id#782L = id#785L))\n      :- Range 0, 1000000000, 1, 3, [id#782L]\n      +- Range 0, 1000, 1, 3, [id#785L]\n\n== Analyzed Logical Plan ==\ncount(1): bigint\nAggregate [(count(1),mode=Complete,isDistinct=false) AS count(1)#797L]\n+- Project [id#782L]\n   +- Join Inner, Some((id#782L = id#785L))\n      :- Range 0, 1000000000, 1, 3, [id#782L]\n      +- Range 0, 1000, 1, 3, [id#785L]\n\n== Optimized Logical Plan ==\nAggregate [(count(1),mode=Complete,isDistinct=false) AS count(1)#797L]\n+- Project\n   +- Join Inner, Some((id#782L = id#785L))\n      :- Range 0, 1000000000, 1, 3, [id#782L]\n      +- Range 0, 1000, 1, 3, [id#785L]\n\n== Physical Plan ==\nTungstenAggregate(key=[], functions=[(count(1),mode=Final,isDistinct=false)], output=[count(1)#797L])\n+- Exchange SinglePartition, None\n   +- TungstenAggregate(key=[], functions=[(count(1),mode=Partial,isDistinct=false)], output=[count#799L])\n      +- Project\n         +- BroadcastHashJoin [id#782L], [id#785L], Inner, BuildRight, None\n            :- Range 0, 1, 3, 1000000000, [id#782L]\n            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint]))\n               +- Range 0, 1, 3, 1000, [id#785L]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.46403907889E12,"submitTime":1.464039063137E12,"finishTime":1.464039079124E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c9496100-7e66-4214-b2e1-a60d0e264126"},{"version":"CommandV1","origId":431554386690954,"guid":"487d4313-805f-45a9-81b6-bd3e60f08b77","subtype":"command","commandType":"auto","position":0.9990234375,"command":"%md\n### How fast can Spark 2.0 join 1 billion records?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364064E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bc8e382f-36d8-4d0e-99af-2fd724e74ace"},{"version":"CommandV1","origId":431554386690955,"guid":"d74ea10d-fd08-434f-b6f9-10ab5d8ce29e","subtype":"command","commandType":"auto","position":0.99951171875,"command":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.0\") {\n  spark.range(1000L * 1000 * 1005).join(spark.range(1040L).toDF(), \"id\").count()\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Time taken in Spark 2.0: 0.864557455 seconds\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.464039123647E12,"submitTime":1.464039107892E12,"finishTime":1.464039124599E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8220b8d5-f2fd-46cb-86ca-e45db5f06d32"},{"version":"CommandV1","origId":431554386690960,"guid":"8555939d-d775-42bd-9fa1-a74ca3431c33","subtype":"command","commandType":"auto","position":0.999755859375,"command":"%md\nThis is even better. From ~ 60 seconds to 0.8 seconds to join 1 billion numbers.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364092E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"57e6afc3-2508-4c55-8390-5e2246824f20"},{"version":"CommandV1","origId":431554386690961,"guid":"d88ebed0-edb8-4134-b41f-9c18bebfb895","subtype":"command","commandType":"auto","position":0.9998779296875,"command":"%md\n### Why are we doing these stupid benchmarks?\n\nThis is an excellent question. While the benchmarks look simple, they actually measure many of the fundamental core primitives in real data processing. For example, aggregation is a very common pattern, and joining integers is one of the most widely used patterns in a well defined star-schema data warehouse (e.g. fact table and dimension table joins).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364095E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8e4a849d-c2d5-45a0-8eaf-99e3c759d4c1"},{"version":"CommandV1","origId":293651311471492,"guid":"4e7ca510-1a87-4d54-a325-19a3c97cee63","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n### Other primitive operations\n\nWe have also benchmarked the efficiency of other primitive operations under whole-stage code generation. The table below summarizes the result:\n\nThe way we benchmark is to to measure the cost per row, in nanoseconds.\n\nRuntime: Intel Haswell i7 4960HQ 2.6GHz, HotSpot 1.8.0_60-b27, Mac OS X 10.11\n\n|                       | Spark 1.6 | Spark 2.0 |\n|:---------------------:|:---------:|:---------:|\n|         filter        |   15 ns   |   1.1 ns  |\n|     sum w/o group     |   14 ns   |   0.9 ns  |\n|      sum w/ group     |   79 ns   |  10.7 ns  |\n|       hash join       |   115 ns  |   4.0 ns  |\n|  sort (8 bit entropy) |   620 ns  |   5.3 ns  |\n| sort (64 bit entropy) |   620 ns  |   40 ns   |\n|    sort-merge join    |   750 ns  |   700 ns  |\n\n\nAgain, to read the companion blog post, click here: https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364098E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a0ddabf7-8dc6-47f9-9a0b-d18a54ad81a4"},{"version":"CommandV1","origId":293651311471493,"guid":"f6c21f63-2a11-4e04-8176-0a5d8e7d24b2","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n### Understanding the execution plan\n\nThe explain function has been extended for whole-stage code generation. When an operator has a star around it (*), whole-stage code generation is enabled. In the following case, Range, Filter, and the two Aggregates are both running with whole-stage code generation. Exchange does not have whole-stage code generation because it is sending data across the network.\n\nThis query plan has two \"stages\" (divided by Exchange). In the first stage, three operators (Range, Filter, Aggregate) are collapsed into a single function. In the second stage, there is only a single operator (Aggregate).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364101E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e1d4a31a-0847-4c50-9824-3a94a08641ec"},{"version":"CommandV1","origId":2614894187198016,"guid":"2e1ee5ee-379e-44cd-99df-271560e99fee","subtype":"command","commandType":"auto","position":4.0,"command":"spark.range(1000).filter(\"id > 100\").selectExpr(\"sum(id)\").explain()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.464035364103E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f8d1b3e1-b098-4276-8660-747fd920d253"}],"dashboards":[],"guid":"9b07e03c-3a3c-4fb1-8cf8-3c8f167f290e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script src="Whole-stage%20code%20generation%20-%20Databricks_files/notebook-main.js" onerror="window.mainJsLoadError = true;"></script>
</head>
<body><div id="static-notebook" data-reactid=".0"><div id="tooltip" class="hidden" data-reactid=".0.0"><p data-reactid=".0.0.0"><span id="value" data-reactid=".0.0.0.0"></span></p></div><div id="topbar" class="" data-reactid=".0.1"><div class="tb-logo" data-reactid=".0.1.0"><a href="http://databricks.com/" target="_blank" title="Databricks" data-reactid=".0.1.0.0"><img src="Whole-stage%20code%20generation%20-%20Databricks_files/databricks_logoTM_rgb_TM.svg" alt="databricks-logo" data-reactid=".0.1.0.0.0"></a></div><div class="tb-title-wrapper tb-title-wrapper-central" data-reactid=".0.1.1"><span data-reactid=".0.1.1.0"><span class="tb-title" data-reactid=".0.1.1.0.0">Whole-stage code generation</span><span class="tb-title-lang" data-reactid=".0.1.1.0.1">(Scala)</span></span></div><div class="tb-import" data-reactid=".0.1.2"><a class="btn btn-default import-button" title="Import Notebook" data-reactid=".0.1.2.0"><i class="fa fa-cloud-upload" data-reactid=".0.1.2.0.0"></i><span data-reactid=".0.1.2.0.1"> Import Notebook</span></a></div></div><div id="overallView" class="" data-reactid=".0.2"><div id="content" data-reactid=".0.2.0"><div class="overallContainer" data-reactid=".0.2.0.0"><div class="shell-top new-notebook no-edit no-run static-notebook" data-reactid=".0.2.0.0.0"><img class="load-spinner" src="Whole-stage%20code%20generation%20-%20Databricks_files/spinner.svg" data-reactid=".0.2.0.0.0.0"><div class="command divider" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider"><hr data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-0 cell-293651311471490-431554386690945" draggable="true" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 165px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="fa22bad6-b3f9-455d-84e5-a2479a02a2a7" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h1>Whole-stage code generation: Spark 2.0's Tungsten engine</h1>
<p>This notebook demonstrates the power of whole-stage code generation, a
 technique that blends state-of-the-art from modern compilers and MPP 
databases. In order to compare the performance with Spark 1.6, we turn 
off whole-stage code generation in Spark 2.0, which would result in 
using a similar code path as in Spark 1.6.</p>
<p>To read the companion blog posts, click the following:</p>
<ul>
<li><a href="https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html">https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html</a></li>
<li><a href="https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html">https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html</a></li>
</ul>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$0c4651b1-033b-485d-9c0b-c865d9968315.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider"><hr data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-1 cell-293651311471490-431554386690946" draggable="true" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 39px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="994ff954-00b1-4b04-9d89-b3efd09088a3" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>First, let's do some benchmark setup</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$9785e801-f510-4b99-a66f-066fd402ee21.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider"><hr data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-2 cell-293651311471490-431554386690947" draggable="true" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 24px; left: 332px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 137px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 332px; top: 19px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment">// Define a simple benchmark util function</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">benchmark</span>(<span class="cm-variable">name</span>: <span class="cm-variable-3">String</span>)(<span class="cm-variable">f</span>: <span class="cm-operator">=&gt;</span> <span class="cm-variable-3">Unit</span>) <span class=" CodeMirror-matchingbracket">{</span></span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-keyword">val</span> <span class="cm-def">startTime</span> <span class="cm-operator">=</span> <span class="cm-variable-3">System</span>.<span class="cm-variable">nanoTime</span></span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-variable">f</span></span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-keyword">val</span> <span class="cm-def">endTime</span> <span class="cm-operator">=</span> <span class="cm-variable-3">System</span>.<span class="cm-variable">nanoTime</span></span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-keyword">println</span>(<span class="cm-variable">s</span><span class="cm-string">"Time taken in $name: "</span> <span class="cm-operator">+</span> (<span class="cm-variable">endTime</span> <span class="cm-operator">-</span> <span class="cm-variable">startTime</span>).<span class="cm-variable">toDouble</span> <span class="cm-operator">/</span> <span class="cm-number">1000000000</span> <span class="cm-operator">+</span> <span class="cm-string">" seconds"</span>)</span></pre><pre class=" CodeMirror-line "><span><span class=" CodeMirror-matchingbracket">}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 137px;"></div><div style="display: none; height: 154px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0.0.0"></noscript><noscript data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0.0.3"></noscript><noscript data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0.0.4"></noscript><noscript data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$c1783d56-f4f7-4418-8ead-a5dd1c1d5d51.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider"><hr data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-3 cell-293651311471490-431554386690956" draggable="true" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 55px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="94f82eaf-ba43-4a82-a1a9-e5bd39d3c398" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>This "cluster" has only a single node, with 3 cores allocated. The CPU is Intel(R) Xeon(R) CPU E5-2670 v2 @ 2.50GHz.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$85449eed-7323-464d-89e7-7f05f1c8b04d.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider"><hr data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-4 cell-293651311471490-431554386690948" draggable="true" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 42px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="145ba0d3-9496-435f-ab0d-8d82f659d776" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>How fast can Spark 1.6 sum up 1 billion numbers?</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$532de9dc-79f4-4ce2-b195-3c3b93da4c10.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider"><hr data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-5 cell-293651311471490-431554386690949" draggable="true" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 118px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment">// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-string">"spark.sql.codegen.wholeStage"</span>, <span class="cm-keyword">false</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">benchmark</span>(<span class="cm-string">"Spark 1.6"</span>) {</span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>).<span class="cm-variable">selectExpr</span>(<span class="cm-string">"sum(id)"</span>).<span class="cm-variable">show</span>()</span></pre><pre class=" CodeMirror-line "><span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 118px;"></div><div style="display: none; height: 135px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0.0.0"></noscript><noscript data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0.0.3"></noscript><noscript data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0.0.4"></noscript><noscript data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$f1f9ebd6-206c-489d-ac1b-936c6f278207.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider"><hr data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-6 cell-293651311471490-431554386690950" draggable="true" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 42px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="f80f70e9-99a3-4217-8e75-144f4f6fe358" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>How fast can Spark 2.0 sum up 1 billion numbers?</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$c6f4b542-413c-4826-89e5-b4e766eb792a.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider"><hr data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-7 cell-293651311471490-431554386690951" draggable="true" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 99px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-string">"spark.sql.codegen.wholeStage"</span>, <span class="cm-atom">true</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">benchmark</span>(<span class="cm-string">"Spark 2.0"</span>) {</span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>).<span class="cm-variable">selectExpr</span>(<span class="cm-string">"sum(id)"</span>).<span class="cm-variable">show</span>()</span></pre><pre class=" CodeMirror-line "><span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 99px;"></div><div style="display: none; height: 116px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0.0.0"></noscript><noscript data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0.0.3"></noscript><noscript data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0.0.4"></noscript><noscript data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$000895cf-c723-4432-8e05-627d19afee68.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider"><hr data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-8 cell-293651311471490-431554386690959" draggable="true" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 49px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="1f38723e-2ef4-4a0b-8ef6-51673823d915" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Woot - that's pretty good. From ~ 8 seconds to 0.7 seconds to sum up 1 billion numbers.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$1b50fb73-26bc-4ec3-a2a0-4d386b7a31db.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider"><hr data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-9 cell-293651311471490-431554386690952" draggable="true" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 41px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="7f0ebf37-6549-45ee-89a8-bfe4b60f41a8" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>How fast can Spark 1.6 join 1 billion records?</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$cd4f0836-b5ac-4811-8be1-f6f5918a0407.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider"><hr data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-10 cell-293651311471490-431554386690953" draggable="true" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 118px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment">// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-string">"spark.sql.codegen.wholeStage"</span>, <span class="cm-keyword">false</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">benchmark</span>(<span class="cm-string">"Spark 1.6"</span>) {</span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>).<span class="cm-variable">join</span>(<span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span>).<span class="cm-variable">toDF</span>(), <span class="cm-string">"id"</span>).<span class="cm-variable">count</span>()</span></pre><pre class=" CodeMirror-line "><span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 118px;"></div><div style="display: none; height: 135px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.3"><div class="ansiout">Time taken in Spark 1.6: 67.949386495 seconds
</div></div><noscript data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.4"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5"><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.0"><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.0.0">Command took </span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.0.1">68.07</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.0.2">s </span></span><span class="command-provenance" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1"><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.0">-- by </span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.1">a user</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.2"> at </span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.3">5/23/2016, 2:28:08 PM</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.4"> on </span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.5">unknown cluster</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.6"> (</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.7">0</span><span data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.0.0.5.1.8"> GB)</span></span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$90288f57-26af-4574-befc-b820c54e97b5.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider"><hr data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-11 cell-293651311471490-781724370396894" draggable="true" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>).<span class="cm-variable">join</span>(<span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span>).<span class="cm-variable">toDF</span>(), <span class="cm-string">"id"</span>).<span class="cm-variable">selectExpr</span>(<span class="cm-string">"count(*)"</span>).<span class="cm-variable">explain</span>(<span class="cm-atom">true</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 23px;"></div><div style="display: none; height: 40px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.3"><div class="ansiout">== Parsed Logical Plan ==
'Project [unresolvedalias('count(1), Some(count(1)))]
+- Project [id#782L]
   +- Join Inner, Some((id#782L = id#785L))
      :- Range 0, 1000000000, 1, 3, [id#782L]
      +- Range 0, 1000, 1, 3, [id#785L]

== Analyzed Logical Plan ==
count(1): bigint
Aggregate [(count(1),mode=Complete,isDistinct=false) AS count(1)#797L]
+- Project [id#782L]
   +- Join Inner, Some((id#782L = id#785L))
      :- Range 0, 1000000000, 1, 3, [id#782L]
      +- Range 0, 1000, 1, 3, [id#785L]

== Optimized Logical Plan ==
Aggregate [(count(1),mode=Complete,isDistinct=false) AS count(1)#797L]
+- Project
   +- Join Inner, Some((id#782L = id#785L))
      :- Range 0, 1000000000, 1, 3, [id#782L]
      +- Range 0, 1000, 1, 3, [id#785L]

== Physical Plan ==
TungstenAggregate(key=[], functions=[(count(1),mode=Final,isDistinct=false)], output=[count(1)#797L])
+- Exchange SinglePartition, None
   +- TungstenAggregate(key=[], functions=[(count(1),mode=Partial,isDistinct=false)], output=[count#799L])
      +- Project
         +- BroadcastHashJoin [id#782L], [id#785L], Inner, BuildRight, None
            :- Range 0, 1, 3, 1000000000, [id#782L]
            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint]))
               +- Range 0, 1, 3, 1000, [id#785L]
</div></div><noscript data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.4"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5"><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.0"><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.0.0">Command took </span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.0.1">0.23</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.0.2">s </span></span><span class="command-provenance" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1"><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.0">-- by </span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.1">a user</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.2"> at </span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.3">5/23/2016, 2:31:03 PM</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.4"> on </span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.5">unknown cluster</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.6"> (</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.7">0</span><span data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.0.0.5.1.8"> GB)</span></span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$2bc0aef9-599b-4419-9d4a-1d1da1425e42.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider"><hr data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-12 cell-293651311471490-431554386690954" draggable="true" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 41px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="516cf6bd-1145-4245-a8ab-ea0e4dc74730" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>How fast can Spark 2.0 join 1 billion records?</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$487d4313-805f-45a9-81b6-bd3e60f08b77.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider"><hr data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-13 cell-293651311471490-431554386690955" draggable="true" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 99px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-string">"spark.sql.codegen.wholeStage"</span>, <span class="cm-atom">true</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">benchmark</span>(<span class="cm-string">"Spark 2.0"</span>) {</span></pre><pre class=" CodeMirror-line "><span>  <span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000L</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span> <span class="cm-operator">*</span> <span class="cm-number">1005</span>).<span class="cm-variable">join</span>(<span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1040L</span>).<span class="cm-variable">toDF</span>(), <span class="cm-string">"id"</span>).<span class="cm-variable">count</span>()</span></pre><pre class=" CodeMirror-line "><span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 99px;"></div><div style="display: none; height: 116px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.3"><div class="ansiout">Time taken in Spark 2.0: 0.864557455 seconds
</div></div><noscript data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.4"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5"><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.0"><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.0.0">Command took </span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.0.1">0.95</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.0.2">s </span></span><span class="command-provenance" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1"><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.0">-- by </span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.1">a user</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.2"> at </span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.3">5/23/2016, 2:31:47 PM</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.4"> on </span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.5">unknown cluster</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.6"> (</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.7">0</span><span data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.0.0.5.1.8"> GB)</span></span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$d74ea10d-fd08-434f-b6f9-10ab5d8ce29e.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider"><hr data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-14 cell-293651311471490-431554386690960" draggable="true" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 47px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="f0d76598-fd7d-41ca-b22d-b3b4f48f15f1" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>This is even better. From ~ 60 seconds to 0.8 seconds to join 1 billion numbers.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$8555939d-d775-42bd-9fa1-a74ca3431c33.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider"><hr data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-15 cell-293651311471490-431554386690961" draggable="true" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 112px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="b75b9e2e-b673-4a68-8a35-15fd3eb334fd" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Why are we doing these stupid benchmarks?</h3>
<p>This is an excellent question. While the benchmarks look simple, they
 actually measure many of the fundamental core primitives in real data 
processing. For example, aggregation is a very common pattern, and 
joining integers is one of the most widely used patterns in a well 
defined star-schema data warehouse (e.g. fact table and dimension table 
joins).</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$d88ebed0-edb8-4134-b41f-9c18bebfb895.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider"><hr data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-16 cell-293651311471490-293651311471492" draggable="true" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 223px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="a795d8a0-ee99-4dbc-8186-446c27d5fe3d" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Other primitive operations</h3>
<p>We have also benchmarked the efficiency of other primitive operations
 under whole-stage code generation. The table below summarizes the 
result:</p>
<p>The way we benchmark is to to measure the cost per row, in nanoseconds.</p>
<p>Runtime: Intel Haswell i7 4960HQ 2.6GHz, HotSpot 1.8.0_60-b27, Mac OS X 10.11</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Spark 1.6</th>
<th style="text-align:center">Spark 2.0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">filter</td>
<td style="text-align:center">15 ns</td>
<td style="text-align:center">1.1 ns</td>
</tr>
<tr>
<td style="text-align:center">sum w/o group</td>
<td style="text-align:center">14 ns</td>
<td style="text-align:center">0.9 ns</td>
</tr>
<tr>
<td style="text-align:center">sum w/ group</td>
<td style="text-align:center">79 ns</td>
<td style="text-align:center">10.7 ns</td>
</tr>
<tr>
<td style="text-align:center">hash join</td>
<td style="text-align:center">115 ns</td>
<td style="text-align:center">4.0 ns</td>
</tr>
<tr>
<td style="text-align:center">sort (8 bit entropy)</td>
<td style="text-align:center">620 ns</td>
<td style="text-align:center">5.3 ns</td>
</tr>
<tr>
<td style="text-align:center">sort (64 bit entropy)</td>
<td style="text-align:center">620 ns</td>
<td style="text-align:center">40 ns</td>
</tr>
<tr>
<td style="text-align:center">sort-merge join</td>
<td style="text-align:center">750 ns</td>
<td style="text-align:center">700 ns</td>
</tr>
</tbody>
</table>
<p>Again, to read the companion blog post, click here: <a href="https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html">https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html</a></p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$4e7ca510-1a87-4d54-a325-19a3c97cee63.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider"><hr data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-17 cell-293651311471490-293651311471493" draggable="true" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="display: block; bottom: 0px;" cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 159px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>%md</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 0px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div style="display: none;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.0.0.0"></noscript><div class="results dashboard" style="display:block;" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.0.0.3"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div data-guid="3d49009a-c86a-44e4-9f43-8ea48368838a" style="left: 0px; top: 0px; width: auto; height: auto;" class="widget"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Understanding the execution plan</h3>
<p>The explain function has been extended for whole-stage code 
generation. When an operator has a star around it (*), whole-stage code 
generation is enabled. In the following case, Range, Filter, and the two
 Aggregates are both running with whole-stage code generation. Exchange 
does not have whole-stage code generation because it is sending data 
across the network.</p>
<p>This query plan has two "stages" (divided by Exchange). In the first 
stage, three operators (Range, Filter, Aggregate) are collapsed into a 
single function. In the second stage, there is only a single operator 
(Aggregate).</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div style="position: absolute; left: 0px; top: 0px; display: none;" class="refresh-controls">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$f6c21f63-2a11-4e04-8176-0a5d8e7d24b2.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider"><hr data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee-divider.2.0"></i></a></div><div class="highlight-inactive" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee"><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-18 cell-293651311471490-2614894187198016" draggable="true" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.0"></div><a class="move-command-btn" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.1.0"></i></a><div class="command-input previousPrompt primaryPrompt" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.4.0"><span class="prompt" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.4.0.0">&gt;&nbsp;</span><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.4.0.1"><textarea style="display: none;" class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.4.0.1.0"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 4px;"><textarea tabindex="1" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div cm-not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div cm-not-content="true" class="CodeMirror-scrollbar-filler"></div><div cm-not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; margin-bottom: -13px; border-right-width: 17px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 4px; top: 0px; height: 19px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">1000</span>).<span class="cm-variable">filter</span>(<span class="cm-string">"id &gt; 100"</span>).<span class="cm-variable">selectExpr</span>(<span class="cm-string">"sum(id)"</span>).<span class="cm-variable">explain</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 17px; width: 1px; top: 23px;"></div><div style="display: none; height: 40px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0.0.0"></noscript><noscript data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0.0.3"></noscript><noscript data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0.0.4"></noscript><noscript data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.0.0.5"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$2e1ee5ee-379e-44cd-99df-271560e99fee.0.5.1"></div></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.$last-command-divider"><hr data-reactid=".0.2.0.0.0.$last-command-divider.0"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.$last-command-divider.1"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.$last-command-divider.1.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.$last-command-divider.2"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.$last-command-divider.2.0"></i></a></div><div class="contentSpacer" style="background:#fff;height:0px;" data-reactid=".0.2.0.0.0.4"></div></div></div></div></div></div></body></html>